
"""
PROJECT_GOLD_PRICE_PREDICTION.ipynb

Automatically generated by Colab.

ðŸ’° Gold Price Prediction using Machine Learning

ðŸ’¡ Project Overview

# Gold Price Prediction

## Objective
Build a Machine Learning regression model that predicts the price of gold (GLD)
based on financial indicators.

This is a Regression problem because:
- The target variable (GLD price) is continuous.

## Dataset
The dataset contains:
- Date column
- Several financial features (SPX, USO, SLV, EUR/USD, etc.)
- 1 target column: GLD (Gold ETF Price)

## Algorithm Used
Random Forest Regressor (Ensemble Learning Method)

"""

# ===============================
# 1. Import Required Libraries
# ===============================

# Numerical operations
import numpy as np

# Data manipulation
import pandas as pd

# Data visualization
import matplotlib.pyplot as plt
import seaborn as sns

# Splitting dataset
from sklearn.model_selection import train_test_split

# Machine Learning model
from sklearn.ensemble import RandomForestRegressor

# Evaluation metrics
from sklearn import metrics


# ===============================
# 2. Load Dataset
# ===============================

# Load dataset into Pandas DataFrame
gold_data = pd.read_csv('/data/gld_price_data.csv')

# Display first 5 rows
gold_data.head()


# ===============================
# 3. Basic Data Exploration
# ===============================

# Dataset shape
print("Dataset Shape:", gold_data.shape)

# Dataset information
gold_data.info()

# Check missing values
print("\nMissing Values:")
print(gold_data.isnull().sum())

# Statistical summary
gold_data.describe()


# ===============================
# 4. Correlation Analysis
# ===============================

# Compute correlation matrix
correlation = gold_data.corr()

# Plot heatmap
plt.figure(figsize=(8,8))
sns.heatmap(
    correlation,
    cbar=True,
    square=True,
    fmt='.1f',
    annot=True,
    annot_kws={'size':8},
    cmap='Blues'
)

# Correlation values with GLD
print("\nCorrelation with GLD:")
print(correlation['GLD'])


# ===============================
# 5. GLD Price Distribution
# ===============================

sns.histplot(gold_data['GLD'], kde=True, color='green')
plt.title("Distribution of GLD Price")
plt.show()


# ===============================
# 6. Separate Features and Target
# ===============================

# Drop Date and Target column
X = gold_data.drop(['Date', 'GLD'], axis=1)

# Target variable
Y = gold_data['GLD']

print("Feature Shape:", X.shape)
print("Target Shape:", Y.shape)


# ===============================
# 7. Split Data
# ===============================

X_train, X_test, Y_train, Y_test = train_test_split(
    X,
    Y,
    test_size=0.2,       # 20% for testing
    random_state=2       # Reproducibility
)

print("Training Shape:", X_train.shape)
print("Testing Shape:", X_test.shape)


# ===============================
# 8. Model Training
# ===============================

# Initialize Random Forest Regressor
regressor = RandomForestRegressor(n_estimators=100)

# Train model
regressor.fit(X_train, Y_train)

print("Model training completed.")


# ===============================
# 9. Model Evaluation
# ===============================

# Predict on test data
test_data_prediction = regressor.predict(X_test)

# R-squared score
error_score = metrics.r2_score(Y_test, test_data_prediction)

print("R Squared Error:", error_score)


# ===============================================
# 10. Visualizing Actual vs Predicted Prices
# ===============================================

# Convert Y_test to list for plotting
Y_test = list(Y_test)

plt.plot(Y_test, color='blue', label='Actual Value')
plt.plot(test_data_prediction, color='green', label='Predicted Value')

plt.title('Actual Price vs Predicted Price')
plt.xlabel('Number of Values')
plt.ylabel('GLD Price')
plt.legend()
plt.show()


# ======================================
# 11. Making a Prediction on New Data
# ======================================

# Example: take a random test sample
sample = X_test.iloc[0]

# Reshape for model input
sample_reshaped = np.asarray(sample).reshape(1, -1)

# Predict
prediction = regressor.predict(sample_reshaped)

print("Predicted Gold Price:", prediction[0])


